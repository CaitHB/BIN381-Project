---
title: "EDA_Literacy_07"
author: "Group K"
date: "`r Sys.Date()`"
output:   pdf_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
# Load required packages
library(tidyverse)
library(skimr)
library(ggplot2)
library(readr)
library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(summarytools)
```
# 1. Loading the dataset 

```{r load-data, message=FALSE}
#load dataset
literacyDataset <- read_csv("../raw_data/literacy_national_zaf.csv", show_col_types = FALSE)
```

## Dislay the first 5 rows
```{r}
kable(
  head(literacyDataset[-1, c("ISO3", "DataId", "Indicator", "Value", "CountryName", "SurveyYear")], 5),
  caption = "First 5 rows of the Access to Health Care Dataset (excluding first row)"
)

```
# 2. Data Overview

## Summary statistics

```{r}
# 1. Remove first row if it's metadata/header
literacy_clean <- literacyDataset[-1, ]  

# 2. Convert relevant numeric columns to numeric
numeric_cols <- c("Value", "DenominatorWeighted", "DenominatorUnweighted", "CILow", "CIHigh")

literacy_clean <- literacy_clean %>%
  mutate(across(all_of(numeric_cols), ~ as.numeric(.)))

# 3. Create a tidy summary table
summary_table <- literacy_clean %>%
  summarise(across(all_of(numeric_cols),
                   list(mean = ~mean(., na.rm = TRUE),
                        sd   = ~sd(., na.rm = TRUE),
                        min  = ~min(., na.rm = TRUE),
                        max  = ~max(., na.rm = TRUE)))) %>%
  pivot_longer(
    cols = everything(),
    names_to = c("Variable", "Statistic"),
    names_sep = "_",
    values_to = "Value"
  ) %>%
  arrange(Variable)

# Save summary table
write_csv(summary_table, "../outputs/summary tables/summary_literacy.csv")

# Display
kable(summary_table, caption = "Summary Statistics for Key Numeric Variables in the Literacy Dataset")
```

# 3. Data Quality 

## Missing values per column
```{r}
missing_values <- colSums(is.na(literacyDataset))
missing_values
```

## Dupilcates
```{r}
duplicates <- sum(duplicated(literacyDataset))
duplicates
```
# 4. Visualizations

```{r}
library(ggplot2)

lit_dist <- literacyDataset %>%
  filter(Indicator %in% c(
    "Women who can read a whole sentence",
    "Women who can read part of a sentence",
    "Women who cannot read at all",
    "Men who can read a whole sentence",
    "Men who can read part of a sentence",
    "Men who cannot read at all"
  )) %>%
  mutate(Value = as.numeric(Value),
         Gender = ifelse(grepl("^Women", Indicator), "Women", "Men"),
         Category = gsub("Women who |Men who ", "", Indicator))

ggplot(lit_dist, aes(x = "", y = Value, fill = Category)) +
  geom_col(width = 1) +
  coord_polar("y") +
  facet_wrap(~Gender) +
  labs(title = "Literacy Status Distribution by Gender (2016)") +
  theme_void()
ggsave("../outputs/visuals/literacyByGender.png", width = 6, height = 4)


```
```{r}
# Keep only % indicators (exclude totals and counts)
lit_data <- literacyDataset %>%
  filter(IndicatorType == "I") %>%
  mutate(Value = as.numeric(Value),
         Gender = ifelse(grepl("^Women", Indicator), "Women", "Men"))

ggplot(lit_data, aes(x = Indicator, y = Value, fill = Gender)) +
  geom_col(position = "dodge") +
  coord_flip() +
  labs(
    title = "Literacy and Education Indicators (South Africa, 2016)",
    x = "Indicator",
    y = "Percentage"
  ) +
  theme_minimal()
ggsave("../outputs/visuals/literacyEducationBarPLot.png", width = 6, height = 4)


```




